<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integrating node apps with UW's SAML &mdash; Siddhartha Gudipati</title>
    <link href="https://fonts.googleapis.com/css?family=Puritan:400,700|Roboto+Mono:300,400,500|Mandali" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/assets/main.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/blog.svg"/>
    <link href="/feed.xml" rel="alternate" type="application/rss+xml" title="Siddhartha Gudipati" />
    <meta name="title" content="Integrating node apps with UW's SAML ">
    <link rel="canonical" href="http://0.0.0.0:4000/integrating-your-node-app-with-uw-saml.html">
    
    
    <meta property="og:title" content="Integrating node apps with UW's SAML "/>
    <meta property="og:url" content="http://0.0.0.0:4000/integrating-your-node-app-with-uw-saml.html"/>
    
    
    <meta property="og:description" content="As part of my on-campus jobs, I built a custom form builder for the UW Dept of Sustainability. I used MEAN (MongoDB, Express.js, Angular.js, Node) as my tech stack. I was the only designer and developer for the whole application. So, for that I was required to integrate the application with UW NetID using SAML. After toiling for a couple of months, I was able to successfully integrate UWNetID with the node application. There was no good documentation on how to do that. So, I decided to write this awesome blog post to help other people like me. **Note:** I..."/>
    <meta name="description" content="As part of my on-campus jobs, I built a custom form builder for the UW Dept of Sustainability. I used MEAN (MongoDB, Express.js, Angular.js, Node) as my tech stack. I was the only designer and developer for the whole application. So, for that I was required to integrate the application with UW NetID using SAML. After toiling for a couple of months, I was able to successfully integrate UWNetID with the node application. There was no good documentation on how to do that. So, I decided to write this awesome blog post to help other people like me. Note: I..."/>
    
    <meta property="og:site_name" content="Siddhartha Gudipati">
</head>
    <body>
        <div class="site">
            <section class="site-nav">
    <header>
        <nav class="nav">
            <div class="nav-left">
                <a class="nav-item is-brand" href="http://websiddu.com"><img src="/images/logo.svg"></a>
                <span class="nav-item is-direction">&rarr;</span>
                <a href="/" class="nav-item is-sub-brand is-tab"> <img src="/images/blog.svg"></a>
            </div>


            <span class="nav-toggle">
                <span></span>
            <span></span>
            <span></span>
            </span>

            <div class="nav-right nav-menu">
                <a class="nav-item " href="http://websiddu.com">
    Portfolio
</a>
<a class="nav-item " href="http://blog.websiddu.com">
    Blog
</a>
<a class="nav-item " href="http://photos.websiddu.com">
    Photos
</a>
<a class="nav-item " href="http://cook.websiddu.com">
    Cook
</a>
<a class="nav-item " href="http://about.websiddu.com">
    About
</a>

            </div>
        </nav>
    </header>
</section>

            <article class="lang-">
    <div class="container">
        <section role="article">
            <h2 class="post-title" role="title">Integrating node apps with UW's SAML</h2>
            <div class="post-meta" role="meta">
                <time>July 28, 2015</time> &mdash;
                <span> 3  minutes read</span>
            </div>
            <main class="post-content">
                
                <div class="post-cover">
                    <img src="images/covers/saml.jpg" alt="Integrating node apps with UW's SAML">
                </div>
                
                <p>As part of my on-campus jobs, I built a custom form builder for the UW Dept of Sustainability. I used MEAN (MongoDB, Express.js, Angular.js, Node) as my tech stack. I was the only designer and developer for the whole application. So, for that I was required to integrate the application with UW NetID using SAML. After toiling for a couple of months, I was able to successfully integrate UWNetID with the node application. There was no good documentation on how to do that. So, I decided to write this awesome blog post to help other people like me.</p>

<p><strong>Note:</strong> I assume that you have prior knowledge working with mongoDB and node. If you don‚Äôt have any idea what those are scroll till the end enjoy the cat gif.</p>

<h3 id="step-1">Step 1:</h3>

<h4 id="get-your-sub-domain">Get your sub-domain.</h4>
<p>First you have to get your subdomain on UW. You should raise a request to the UWIT for the subdomain. In my case its ‚Äúgreen-certification.uw.edu‚Äù. Send an email to help@uw.edu if you have proper permissions. And ask them to point it to your DNS server(If you got one)</p>

<h3 id="step-2">Step 2:</h3>

<h4 id="get-valid-certificates">Get valid certificates</h4>
<p>Second you need to get valid HTTPS certificates for your server. You have to use those certificates to run the node server and the shibboleth sever. You can get those from UWIT again. Just send an email to help@uw.edu requisition for brand new secure certificates for your newborn domain.</p>

<h3 id="step-3">Step 3:</h3>

<h4 id="install-shibb-on-your-server">Install Shibb on your server</h4>
<p>Then, next you have to install Shibboleth on your server(You don‚Äôt have to install apache). Follow this link  https://wiki.shibboleth.net/confluence/display/SHIB2/Installation
or again request UWIT to install it, if you have a server that is managed by the UWIT.  Once you configured the Shibboleth on to your server, make sure you are running some server it can be node or apache or any other.</p>

<p>Here is my shibb configuration file
<script src="https://gist.github.com/websiddu/b45f9b2b941b8252bb62.js"></script></p>

<p>Make sure you remember the EntitiyID in line number 10 that should match with your EnitityID in the IDP server. And also make sure that you give valid certificates <code>CredentialResolver</code> at line number 59 and 60.</p>

<p>You should be able to get the XML metadata
https://green-certification.uw.edu/Shibboleth.sso/Metadata with proper values.</p>

<h3 id="step-4">Step 4:</h3>

<h4 id="register-your-server-with-idp">Register your server with IDP</h4>
<p>Once you get all the details correct you should ask UWIT to register your server with the IDP. Be careful about the name and make sure that you ask to release the attributes that are required(e.g NetID, FullName etc‚Ä¶). You can check the IDP in this URL https://iam-tools.u.washington.edu/spreg/</p>

<p><img src="http://res.cloudinary.com/websiddu/image/upload/v1440464533/saml1_yn7gcm.png" alt="Img" /></p>

<p>Make sure this entityID matches with the entityID in your sihbb metadata. Also, ask for the ACS POST request to point to the correct URL.  Once you are authenticated the data is passed to this URL as post request, so this is where you do all important stuff.</p>

<h3 id="step-5">Step 5:</h3>

<h4 id="integrate-netid">Integrate netID</h4>
<p>In your node application use the library uwshib (https://github.com/drstearns/passport-uwshib) to integrate your application. And again make sure that you used the same entityID and Certificates that you used before to run the https server.</p>

<p><small>Taken from https://github.com/drstearns/passport-uwshib </small></p>

<script src="https://gist.github.com/websiddu/25c3958156d502c8ce5d.js"></script>

<script src="https://gist.github.com/websiddu/6bef6b86d7ec33e23be1.js"></script>

<h3 id="step-6">Step 6:</h3>

<h4 id="sleep-in-peace">Sleep in peace</h4>

<p><img src="http://thoughtcatalog.files.wordpress.com/2013/05/cat1.gif?w=800&amp;h=570" alt="Cat" /></p>

<h3 id="further-reading">Further reading:</h3>
<ul>
  <li>Email me at me@websiddu.com if you have any questions</li>
  <li>Read passport.js documentation</li>
</ul>


            </main>
        </section>
        
        <section>
            <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'websiddu'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
        </section>
        
    </div>
</article>

            <footer class="site-footer">
    <div class="container">
        <div class="columns">
            <div class="column is-5">
                <div class="level-item">
                    <p style="">
                        Hey üëãüèΩ, my name is Siddhartha, I'm a Designer at Google living in the bayarea. I enjoy cooking, photography, coding &amp; more. Follow me <a href="http://twitter.com/websiddu" target="_blank">@websiddu</a>.
                    </p>
                </div>
            </div>
            <div class="column is-3"></div>
            <div class="column is-4">
                <div class="level-item">
                    <div class="nav-right nav-menu">
                        <a class="nav-item " href="http://websiddu.com">
    Portfolio
</a>
<a class="nav-item " href="http://blog.websiddu.com">
    Blog
</a>
<a class="nav-item " href="http://photos.websiddu.com">
    Photos
</a>
<a class="nav-item " href="http://cook.websiddu.com">
    Cook
</a>
<a class="nav-item " href="http://about.websiddu.com">
    About
</a>

                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>

        </div>
        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>
<script src="/assets/main.js"></script>





  <!--google analytics tracking code here-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55363605-4', 'auto');
  ga('send', 'pageview');

</script>



    </body>
</html>
